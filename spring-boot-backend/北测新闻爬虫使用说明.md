# 北测新闻爬虫使用说明

## 功能概述

`BeiceCrawler.java` 是一个专门用于爬取北测官网新闻资讯数据的爬虫程序。该爬虫能够：

- 爬取北测官网新闻列表页面
- 获取每条新闻的详细信息
- 将数据保存为CSV格式文件
- 支持多种HTML选择器，适应不同的页面结构

## 主要特性

### 1. 数据爬取字段
- **标题**: 新闻标题
- **链接**: 新闻详情页链接
- **发布时间**: 新闻发布时间
- **摘要**: 新闻摘要
- **内容**: 新闻详细内容
- **作者**: 新闻作者
- **分类**: 新闻分类
- **图片**: 新闻中的图片链接
- **爬取时间**: 数据爬取的时间戳

### 2. 技术特点
- 使用Java 11+的HttpClient进行网络请求
- 使用Jsoup进行HTML解析
- 支持多种CSS选择器，提高兼容性
- 包含请求间隔，避免对服务器造成压力
- 完整的错误处理和日志记录
- CSV格式输出，便于数据分析

### 3. 请求头配置
爬虫模拟真实浏览器请求，包含完整的HTTP头信息：
- User-Agent: Chrome 136浏览器标识
- Accept: 支持的MIME类型
- Accept-Language: 中文语言偏好
- 安全相关头部: Sec-Ch-Ua, Sec-Fetch-*等

### 4. 详情页爬取功能
- **智能跳转**: 自动跳转到每条新闻的详情页面
- **完整内容**: 获取新闻的完整正文内容
- **多选择器**: 使用多种CSS选择器适应不同页面结构
- **容错机制**: 如果某个选择器失败，会尝试其他选择器
- **测试模式**: 提供专门的测试模式验证详情页爬取功能

### 5. 多种测试模式
- **帮助模式**: 显示所有可用命令和使用方法
- **详情页测试**: 测试单个详情页的爬取功能
- **列表测试**: 测试新闻列表页面的解析功能
- **完整爬取**: 执行完整的爬取流程（列表+详情）
- **自定义URL测试**: 测试任意指定URL的爬取功能
- **友好输出**: 使用表情符号和颜色输出，便于查看结果

## 使用方法

### 方法一：使用Maven运行
```bash
# 显示帮助信息
mvn exec:java -Dexec.mainClass="com.certification.crawler.certification.BeiceCrawler" -Dexec.args="help"

# 测试详情页爬取模式
mvn exec:java -Dexec.mainClass="com.certification.crawler.certification.BeiceCrawler" -Dexec.args="detail"

# 测试新闻列表爬取模式
mvn exec:java -Dexec.mainClass="com.certification.crawler.certification.BeiceCrawler" -Dexec.args="list"

# 完整爬取模式（列表+详情）
mvn exec:java -Dexec.mainClass="com.certification.crawler.certification.BeiceCrawler" -Dexec.args="full"

# 测试指定URL
mvn exec:java -Dexec.mainClass="com.certification.crawler.certification.BeiceCrawler" -Dexec.args="url https://www.ntek.org.cn/zixun/13-3095.html"
```

### 方法二：使用批处理脚本
```bash
# 运行完整批处理脚本（会提示选择模式）
run_beice_crawler.bat

# 运行快速测试脚本
quick_test.bat

# 运行详情页测试脚本
test_detail_crawl.bat
```

### 方法三：在代码中调用
```java
BeiceCrawler crawler = new BeiceCrawler();

// 完整爬取
crawler.crawlNewsData();

// 测试详情页爬取
crawler.testDetailCrawl();

// 测试新闻列表爬取
crawler.testListCrawl();

// 测试指定URL
crawler.testCustomUrl("https://www.ntek.org.cn/zixun/13-3095.html");
```

## 输出文件

爬虫运行完成后，会在项目根目录生成 `beice_news_data.csv` 文件，包含以下列：

| 列名 | 说明 |
|------|------|
| 标题 | 新闻标题 |
| 链接 | 新闻详情页URL |
| 发布时间 | 新闻发布时间 |
| 摘要 | 新闻摘要 |
| 内容 | 新闻详细内容 |
| 作者 | 新闻作者 |
| 分类 | 新闻分类标签 |
| 图片 | 新闻中的图片链接（多个用分号分隔） |
| 爬取时间 | 数据爬取的时间戳 |

## 配置说明

### 目标URL
- 基础URL: `https://www.ntek.org.cn`
- 新闻列表页: `https://www.ntek.org.cn/xinwenzixun.html`

### 选择器配置
爬虫使用多种CSS选择器来适应不同的页面结构：

**新闻列表选择器**:
- `.news-list .news-item`
- `.list-item`
- `.article-item`
- `a[href*='news']`
- `a[href*='article']`
- `.content a`

**标题选择器**:
- `h3, h4`
- `.title, .news-title`
- `a`

**时间选择器**:
- `.time, .date, .publish-time`

**内容选择器**:
- `.content, .article-content, .news-content, .main-content`

## 注意事项

1. **请求频率**: 爬虫在获取详情页时会有1秒的间隔，避免对服务器造成压力
2. **错误处理**: 如果某个新闻详情获取失败，会记录警告日志但不会中断整个爬取过程
3. **数据验证**: 只有包含标题和链接的新闻项才会被保存
4. **CSV转义**: 自动处理CSV字段中的特殊字符，确保文件格式正确

## 依赖库

- **Jsoup**: HTML解析库
- **SLF4J**: 日志框架
- **Java 11+**: 使用HttpClient进行网络请求

## 扩展功能

如需扩展功能，可以：

1. **修改选择器**: 根据实际页面结构调整CSS选择器
2. **添加字段**: 在NewsItem类中添加新的数据字段
3. **修改输出格式**: 支持JSON、XML等其他格式
4. **添加数据库支持**: 将数据直接保存到数据库
5. **分页爬取**: 支持多页面爬取

## 故障排除

### 常见问题

1. **无法获取页面**: 检查网络连接和目标URL是否可访问
2. **解析不到数据**: 检查页面结构是否发生变化，调整CSS选择器
3. **CSV文件乱码**: 确保使用UTF-8编码打开CSV文件
4. **请求被拒绝**: 可能需要调整请求头或添加代理

### 调试建议

1. 查看控制台日志输出
2. 检查生成的CSV文件内容
3. 使用浏览器开发者工具分析页面结构
4. 调整选择器或请求参数

## 更新日志

- **v1.0**: 初始版本，支持基本的新闻数据爬取和CSV输出
